{"version":3,"sources":["../lib/HtmlElements.js"],"names":[],"mappings":"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","file":"HtmlElements.js","sourcesContent":["\nconst logger = Loggers.create(__filename, 'info');\n\nconst SelfClosingElementNames = Strings.splitSpace(`\n   area base basefont br hr input img link meta\n   `\n);\n\nconst ElementNames = Strings.splitSpace(`\n   html head meta link script body\n   header nav h1 h2 h3 h4 h5 h6\n   section article aside\n   table thead tbody th tr td\n   div span pre p hr br img i b tt\n   `\n);\n\nclass Element {\n\n   constructor({name, attributes, children}) {\n   }\n\n}\n\nclass HtmlElement {\n\n   constructor({name, attributes, children}) {\n   }\n\n   render() {\n      return '';\n   }\n}\n\nexport function html(strings, ...values) {\n   strings = strings.map(string => string.replace(/^\\s*\\n\\s*/, ''));\n   logger.debug('html', strings, values);\n   let previousString = strings[0];\n   return values.reduce((result, value, index) => {\n      const nextString = strings[index + 1];\n      if (!Values.isDefined(value)) {\n         value = '';\n      }\n      try {\n         if (lodash.endsWith(previousString, '=')) {\n            if (/^[\"']/.test(nextString)) {\n               throw {message: 'quotes'};\n            } else if (lodash.isString(value)) {\n               value = '\"' + value + '\"';\n            } else {\n               throw {message: typeof value};\n            }\n         }\n         if (lodash.endsWith(previousString, '=\\'')) {\n            if (!/^'/.test(nextString)) {\n               throw {message: 'missing closing single quote'};\n            } else if (lodash.isString(value)) {\n            } else {\n               throw {message: typeof value};\n            }\n         }\n         if (lodash.endsWith(previousString, '=\\\"')) {\n            if (!/^\"/.test(nextString)) {\n               throw {message: 'missing closing double quote'};\n            } else if (lodash.isString(value)) {\n            } else {\n               throw {message: typeof value};\n            }\n         }\n         if (lodash.isArray(value)) {\n            value = lodash.flatten(value).join('\\n');\n         } else if (lodash.isString(value)) {\n         } else {\n            throw {message: 'value type: ' + typeof value};\n         }\n      } catch (err) {\n         logger.error('html', err.message, {previousString, value, nextString});\n         throw err;\n      }\n      previousString = nextString;\n      return result + value + nextString;\n   }, previousString);\n}\n\nexport function renderPath(path) {\n   if (lodash.isArray(path)) {\n      return ['', ...path].join('/');\n   } else if (lodash.isString(path)) {\n      return path;\n   } else {\n      return '/routes';\n      logger.warn('path type', typeof path);\n   }\n}\n\nexport function element(name, attributes, ...args) {\n   const content = [];\n   if (!attributes) {\n      content.push(`<${name}/>`);\n   } else {\n      assert(lodash.isObject(attributes), 'attributes: ' + name);\n      const children = lodash.compact(lodash.flatten(args));\n      const attrs = Objects.kvs(attributes)\n      .filter(kv => kv.key !== 'meta')\n      .filter(kv => kv.value && kv.value.toString())\n      .map(kv => ({key: kv.key, value: kv.value.toString()}))\n      .map(kv => `${kv.key}=\"${kv.value}\"`);\n      logger.debug('element', name, attrs);\n      if (attrs.length) {\n         if (children.length) {\n            content.push(`<${name} ${attrs.join(' ')}>`);\n            content.push(lodash.flatten(children));\n            content.push(`</${name}>`);\n         } else {\n            content.push(`<${name} ${attrs.join(' ')}/>`);\n         }\n      } else {\n         if (children.length) {\n            content.push(`<${name}>`);\n            content.push(lodash.flatten(children));\n            content.push(`</${name}>`);\n         } else if (attributes.meta === 'optional') {\n         } else {\n            content.push(`<${name}/>`);\n         }\n      }\n   }\n   return lodash.flatten(content).join('');\n}\n\nfunction _style(name, style, ...children) {\n   logger.debug('_style', name, style, children);\n   if (typeof style !== 'string') {\n      throw {message: 'style type: ' + typeof style, name, style, children};\n   } else {\n      return element(name, {style}, ...children);\n   }\n}\n\nfunction _content(name, ...children) {\n   return element(name, {}, ...children);\n}\n\nexport function createElements() {\n   return ElementNames.reduce((result, name) => {\n      result[name] = (...args) => element(name, ...args);\n      return result;\n   }, {});\n}\n\nexport function createStyleElements() {\n   return ElementNames.reduce((result, name) => {\n      result[name] = (...args) => _style(name, ...args);\n      return result;\n   }, {});\n}\n\nexport function createOptionalStyleElements() {\n   return ElementNames.reduce((result, name) => {\n      result[name] = (style, ...args) => element(name, {meta: 'optional', style}, ...args);\n      return result;\n   }, {});\n}\n\nexport function createOptionalContentElements() {\n   return ElementNames.reduce((result, name) => {\n      result[name] = (...args) => element(name, {meta: 'optional'}, ...args);\n      return result;\n   }, {});\n}\n\n\nexport function createContentElements() {\n   return ElementNames.reduce((result, name) => {\n      result[name] = (...args) => _content(name, ...args);\n      return result;\n   }, {});\n}\n\nexport function assignDeps(g) {\n   g.He = createElements();\n   g.Hs = createStyleElements();\n   g.Hso = createOptionalStyleElements();\n   g.Hc = createContentElements();\n   g.Hco = createOptionalContentElements();\n   g.Hx = module.exports;\n   g.html = html;\n}\n"]}