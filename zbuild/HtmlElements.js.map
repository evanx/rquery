{"version":3,"sources":["../lib/HtmlElements.js"],"names":[],"mappings":"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","file":"HtmlElements.js","sourcesContent":["\nconst logger = Loggers.create(__filename, 'info');\n\nconst SelfClosingElementNames = Strings.splitSpace(`\n   area base basefont br hr input img link meta\n   `\n);\n\nconst ElementNames = Strings.splitSpace(`\n   html head meta link script body\n   header footer nav section article aside\n   h1 h2 h3 h4 h5 h6\n   table thead tbody th tr td\n   div span pre p a hr br img i b tt\n   `\n);\n\nexport const MessageTagRegex = /<\\/?(b|tt|i|code|pre)>/g;\n\n// experimental\n\nclass Element {\n\n   constructor({name, attributes, children}) {\n   }\n\n}\n\nclass HtmlElement {\n\n   constructor({name, attributes, children}) {\n   }\n\n   toString() {\n      return '';\n   }\n}\n\n\n// html template literal function\n\nexport function html(strings, ...values) {\n   strings = strings.map(string => string.replace(/^\\s*\\n\\s*/, ''));\n   logger.debug('html', strings, values);\n   let previousString = strings[0];\n   return values.reduce((result, value, index) => {\n      const nextString = strings[index + 1];\n      if (!Values.isDefined(value)) {\n         value = '';\n      }\n      try {\n         if (lodash.endsWith(previousString, '=')) {\n            if (/^[\"']/.test(nextString)) {\n               throw {message: 'quotes'};\n            } else if (lodash.isString(value)) {\n               value = '\"' + value + '\"';\n            } else {\n               throw {message: typeof value};\n            }\n         }\n         if (lodash.endsWith(previousString, '=\\'')) {\n            if (!/^'/.test(nextString)) {\n               throw {message: 'missing closing single quote'};\n            } else if (lodash.isString(value)) {\n            } else {\n               throw {message: typeof value};\n            }\n         }\n         if (lodash.endsWith(previousString, '=\\\"')) {\n            if (!/^\"/.test(nextString)) {\n               throw {message: 'missing closing double quote'};\n            } else if (lodash.isString(value)) {\n            } else {\n               throw {message: typeof value};\n            }\n         }\n         if (lodash.isArray(value)) {\n            value = lodash.flatten(value).join('\\n');\n         } else if (lodash.isString(value)) {\n         } else {\n            throw {message: 'value type: ' + typeof value};\n         }\n      } catch (err) {\n         logger.error('html', err.message, {previousString, value, nextString});\n         throw err;\n      }\n      previousString = nextString;\n      return result + value + nextString;\n   }, previousString);\n}\n\n// element renderer\n\nexport function render(name, attributes, ...children) { // TODO\n   const content = [];\n   if (!attributes) {\n      return ['<', name, '/>'].join('');\n   }\n   children = lodash.compact(lodash.flatten(children));\n   if (!lodash.isObject(attributes)) {\n      throw {message: 'attributes: ' + typeof attributes, context: {name, attributes, children}};\n   }\n   const attrs = renderAttributes(attributes);\n   logger.debug('render', name, attrs);\n   return renderChildrenRepeat(name, attributes, attrs, children);\n}\n\nfunction renderAttributes(attributes) {\n   return Object.keys(attributes)\n   .filter(key => !['meta'].includes(key))\n   .filter(key => attributes[key])\n   .map(key => `${key}=\"${attributes[key].toString()}\"`);\n}\n\nfunction renderChildrenRepeat(name, attributes, attrs, children) {\n   if (isMeta(attributes, 'repeat')) {\n      if (!children.length) {\n         return '';\n      } else if (!lodash.isArray(children)) {\n         throw {message: 'children type: ' + typeof children, name, attributes, children};\n      } else if (lodash.isEmpty(children)) {\n         return '';\n      } else {\n         return lodash.flatten(children).map(child => {\n            return renderChildren(name, attributes, attrs, child);\n         }).join('\\n');\n      }\n   } else {\n      return renderChildren(name, attributes, attrs, children);\n   }\n}\n\nfunction renderChildren(name, attributes, attrs, children) {\n   const content = [];\n   children = lodash.flatten(children);\n   if (!children.length) {\n      if (isMeta(attributes, 'optional')) {\n         return '';\n      }\n   }\n   if (!attrs.length && !children.length) {\n      if (SelfClosingElementNames.includes(name)) {\n         return `<${name}/>`;\n      } else {\n         return `<${name}></${name}>`;\n      }\n   } else if (attrs.length && children.length) {\n      content.push(`<${name} ${attrs.join(' ')}>`);\n      content.push(joinContent(name, attributes, children));\n      content.push(`</${name}>`);\n   } else if (attrs.length) {\n      if (SelfClosingElementNames.includes(name)) {\n         content.push(`<${name} ${attrs.join(' ')}/>`);\n      } else {\n         content.push(`<${name} ${attrs.join(' ')}></${name}>`);\n      }\n   } else {\n      content.push(`<${name}>`);\n      content.push(joinContent(name, attributes, children));\n      content.push(`</${name}>`);\n   }\n   return joinContent(name, attributes, content);\n}\n\nfunction isMeta(attributes, metaName) {\n   logger.debug('isMeta', attributes, metaName);\n   if (!attributes.meta) {\n      return false;\n   } else if (lodash.isString(attributes.meta)) {\n      return attributes.meta === metaName;\n   } else if (lodash.isArray(attributes.meta)) {\n      return attributes.meta.includes(metaName);\n   } else {\n      throw {message: 'Meta type: ' + typeof attributes.meta, attributes};\n   }\n}\n\nfunction joinContent(name, attributes, ...children) {\n   children = lodash.flatten(children);\n   if (name === 'pre') {\n      return children.join('\\n');\n   } else {\n      return children.join('');\n   }\n}\n\nexport function renders(fn) {\n   return ElementNames.reduce((result, name) => {\n      result[name] = (...args) => fn(name, ...args);\n      return result;\n   }, {});\n}\n\n// util\n\nexport function onClick({href, target}) {\n   let parts = [];\n   if (!target) {\n      parts.push(`document.body.style.opacity=.4`);\n   }\n   if (!href) {\n      logger.debug('onClick empty');\n   } else if (/^https?:\\/\\//.test(href)) {\n      return renderScript(\n         ...parts,\n         `window.location='${renderPath(href)}'`\n      );\n   } else if (href[0] === '/') {\n      return renderScript(\n         ...parts,\n         `window.location.pathname='${renderPath(href)}'`\n      );\n   } else {\n      return renderScript(\n         ...parts,\n         `window.location.pathname='/${renderPath(href)}'`\n      );\n   }\n}\n\nexport function renderScript(...lines) {\n   return lodash.compact(lines).join(';');\n}\n\nexport function renderPath(path) {\n   if (lodash.isArray(path)) {\n      return ['', ...path].join('/');\n   } else if (lodash.isString(path)) {\n      return path;\n   } else {\n      return '/routes';\n      logger.warn('path type', typeof path);\n   }\n}\n\n// util\n\nexport function ms(meta, style) {\n   return {meta, style};\n}\n\n// plain\n\nexport function plain(name, attributes, content) {\n   if (['style'].includes(name)) {\n      return '';\n   }\n   if (lodash.isEmpty(content)) {\n      return '';\n   }\n   if (lodash.isString(content)) {\n      if (name === 'a') {\n         assert(attributes.href, 'href');\n         return [content, '  ' + attributes.href].join('\\n');\n      }\n      return content;\n   }\n   if (lodash.isArray(content)) {\n      if (['pre'].includes(name)) {\n         return content.map(element => plain({}, content)).join('\\n');\n      } else {\n         return content.map(element => plain({}, content)).join('\\n');\n      }\n   }\n   if (lodash.isObject(element)) {\n      if (element.url && element.content) {\n         return [element.content, element.url].join('\\n');\n      } else {\n         logger.debug('render object', typeof element);\n         return '';\n      }\n   }\n   return content.toString();\n}\n\n//\n\nfunction assignElements($, delegate) {\n   Object.assign($, renders((name, ...args) => delegate(name, ...args)));\n   return $;\n}\n\nexport function assignDeps(g) {\n   g.He = assignElements({}, render);\n   g.Hp = assignElements({}, plain);\n   g.Hs = renders((name, style, ...children) => {\n      logger.debug('_style', name, style, children);\n      if (typeof style !== 'string') {\n         throw {message: 'style type: ' + typeof style, name, style, children};\n      } else {\n         return render(name, {style}, ...children);\n      }\n   });\n   g.Hm = renders((name, meta, attributes, ...args) => render(name, Object.assign({meta}, attributes), args));\n   g.Hso = renders((name, style, ...args) => render(name, Object.assign({meta: 'optional', style}), args));\n   g.Hms = renders((name, meta, style, ...args) => render(name, Object.assign({meta, style}), args));\n   g.Hc = renders((name, ...args) => render(name, {}, args));\n   g.Hmc = renders((name, meta, ...args) => render(name, {meta}, args));\n   g.Hco = renders((name, ...args) => render(name, {meta: 'optional'}, args));\n   g.Hx = module.exports;\n   g.html = html;\n}\n"]}