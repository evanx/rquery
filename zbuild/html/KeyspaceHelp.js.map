{"version":3,"sources":["../../rquery/html/KeyspaceHelp.js"],"names":[],"mappings":"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","file":"KeyspaceHelp.js","sourcesContent":["\nimport styles from './styles';\n\nconst CustomCommandKeys = ['ttls'];\n\nconst logger = Loggers.create(module.filename, 'info');\n\nexport function obscureKeyspaceLabel(reqx) {\n   if (reqx.account === 'hub' && reqx.keyspace.length > 6) {\n      return reqx.keyspace.substring(0, 6);\n   } else {\n      return reqx.keyspace;\n   }\n}\n\nexport function render(props) {\n   let keyspaceLabel = obscureKeyspaceLabel(props.reqx);\n   logger.debug('props', keyspaceLabel, Object.keys(props), Object.keys(Hx));\n   const commands = props.result.commands\n   .filter(command => !['help', 'routes', 'about'].includes(command.key))\n   .filter(command => !command.key.startsWith('verify'))\n   .filter(command => !command.key.startsWith('gen'))\n   .filter(command => !command.key.includes('keyspace'))\n   .filter(command => !command.key.includes('register'));\n   const customCommands = commands\n   .filter(command => isCustomCommand(command));\n   logger.debug('customCommands', customCommands.map(command => command.key).join(' '));\n   const standardCommands = commands\n   .filter(command => !isCustomCommand(command));\n   logger.debug('standardCommands', standardCommands.map(command => command.key).join(' '));\n   return Object.assign(props, {\n      title: [props.reqx.account, keyspaceLabel].join('/'),\n      heading: [Hc.b(props.reqx.account), Hs.tt(styles.header.keyspace, keyspaceLabel)].join(''),\n      backPath: '/routes',\n      icon: 'database',\n      helpPath: ['routes'],\n      content: [\n         Hs.div(styles.result.message, props.result.message),\n         Hsr.p(styles.result.description, props.result.description),\n         renderUrls(props.result.exampleUrls, props.commandMap),\n         He.br(),\n         Hs.h4(styles.result.message, props.result.commandReferenceMessage),\n         renderStandardCommands(standardCommands),\n         Hs.h4(styles.result.message, props.result.customCommandHeading),\n         renderCustomCommands(customCommands),\n      ]\n   });\n}\n\nfunction renderUrls(urls, commandMap) {\n   return urls.map((url, index) => {\n      const urip = url.split('://')[1].split('/').slice(2);\n      const [account, keyspace, commandKey, ...params] = urip;\n      logger.debug('render url', url, commandKey, params, commandMap.get(commandKey));\n      if (commandKey) {\n         let description = '';\n         const command = commandMap.get(commandKey);\n         if (command) {\n            if (command.description) {\n               description = lodash.capitalize(command.description);\n            }\n         }\n         return html`\n         <div style=${styles.keyspaceHelp.linkContainer}>\n            <a href=${url}>\n               <div style=${styles.keyspaceHelp.command}>\n                  <b>${commandKey}</b> ${params || ''}\n               </div>\n               <div style=${styles.keyspaceHelp.commandDescription}>${description}</div>\n            </a>\n         </div>\n         `;\n      } else {\n         return html`\n         <div style=\"${styles.keyspaceHelp.linkContainer}\">\n            <a href=${url}>${url}</a>\n         </div>\n         `;\n      }\n   });\n}\n\nfunction isCustomCommand(command) {\n   return (command.key.indexOf('-') > 0) || ['ttls', 'types', 'rrange', 'rrevrange'].includes(command.key);\n}\n\nfunction getCommandLink(command) {\n   return 'http://redis.io/commands/' + command.key.toUpperCase();\n}\n\nfunction renderUpperCaseCommandString(command) {\n   if (!command.params) {\n      return command.key;\n   }\n   return [Hc.b(command.key.toUpperCase()), ...command.params].join(' ');\n}\n\nfunction renderCommandString(command) {\n   if (!command.params) {\n      return command.key;\n   }\n   return [Hc.b(command.key), ...command.params].join(' ');\n}\n\nfunction renderCustomCommands(commands) {\n   return commands.map(command => {\n      const commandString = renderCommandString(command);\n      return [\n         Hs.div(styles.keyspaceHelp.command, Hc.span(commandString)),\n      ];\n   });\n}\n\nfunction renderStandardCommands(commands) {\n   return commands.map(command => {\n      const commandString = renderUpperCaseCommandString(command);\n      const href = getCommandLink(command);\n      return [\n         Hs.div(styles.keyspaceHelp.command, He.a({href}, commandString))\n      ];\n   });\n}\n"]}