{"version":3,"sources":["../../rquery/html/KeyspaceHelp.js"],"names":[],"mappings":"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","file":"KeyspaceHelp.js","sourcesContent":["\nimport styles from './styles';\n\nconst CustomCommandKeys = ['ttls'];\n\nconst logger = Loggers.create(module.filename, 'info');\n\nexport function obscureKeyspaceLabel(reqx) {\n   if (reqx.account === 'hub' && reqx.keyspace.length > 6) {\n      return reqx.keyspace.substring(0, 6);\n   } else {\n      return reqx.keyspace;\n   }\n}\n\nexport function render(props) {\n   let keyspaceLabel = obscureKeyspaceLabel(props.reqx);\n   logger.debug('props', keyspaceLabel, Object.keys(props), Object.keys(Hx));\n   const commands = props.result.commands\n   .filter(command => !['help', 'routes', 'about'].includes(command.key))\n   .filter(command => !command.key.startsWith('verify'))\n   .filter(command => !command.key.startsWith('gen'))\n   .filter(command => !command.key.includes('keyspace'))\n   .filter(command => !command.key.includes('register'));\n   const customCommands = commands\n   .filter(command => isCustomCommand(command));\n   logger.debug('customCommands', customCommands.map(command => command.key).join(' '));\n   const standardCommands = commands\n   .filter(command => !isCustomCommand(command));\n   logger.debug('standardCommands', standardCommands.map(command => command.key).join(' '));\n   return Object.assign(props, {\n      title: [props.reqx.account, keyspaceLabel].join('/'),\n      heading: [Hc.b(props.reqx.account), Hs.tt(styles.header.keyspace, keyspaceLabel)].join(''),\n      helpPath: '/routes',\n      icon: 'database',\n      helpPath: ['routes'],\n      content: [\n         Hc.h3(props.result.message),\n         He.p(Styles.meta('repeat', styles.result.description), props.result.description),\n         renderUrls(props.result.exampleUrls),\n         He.br(),\n         Hs.h4(styles.result.message, props.result.commandReferenceMessage),\n         renderStandardCommands(standardCommands),\n         Hs.h4(styles.result.message, props.result.customCommandHeading),\n         renderCustomCommands(customCommands),\n      ]\n   });\n}\n\nfunction renderUrls(urls) {\n   return urls.map((url, index) => {\n      const [matching, hostUrl, command, params] = url.match(/^(https?:\\/\\/[^\\/]+)\\/ak\\/[^\\/]+\\/[^\\/]+\\/([^\\/]+)(\\/\\S+)?$/) || [];\n      if (matching) {\n         return html`\n         <div style=\"${styles.keyspaceHelp.linkContainer}\">\n         <a href=${url}><b>${command}</b>${params || ''}</a>\n         </div>\n         `;\n      } else {\n         return html`\n         <div style=\"${styles.keyspaceHelp.linkContainer}\">\n         <a href=${url}>${url}</a>\n         </div>\n         `;\n      }\n   });\n}\n\nfunction isCustomCommand(command) {\n   return (command.key.indexOf('-') > 0) || ['ttls', 'types', 'rrange', 'rrevrange'].includes(command.key);\n}\n\nfunction getCommandLink(command) {\n   return 'http://redis.io/commands/' + command.key.toUpperCase();\n}\n\nfunction renderUpperCaseCommandString(command) {\n   if (!command.params) {\n      return command.key;\n   }\n   return [Hc.b(command.key.toUpperCase()), ...command.params].join(' ');\n}\n\nfunction renderCommandString(command) {\n   if (!command.params) {\n      return command.key;\n   }\n   return [Hc.b(command.key), ...command.params].join(' ');\n}\n\nfunction renderCustomCommands(commands) {\n   return commands.map(command => {\n      const commandString = renderCommandString(command);\n      return [\n         Hs.div(styles.keyspaceHelp.command, Hc.span(commandString)),\n      ];\n   });\n}\n\nfunction renderStandardCommands(commands) {\n   return commands.map(command => {\n      const commandString = renderUpperCaseCommandString(command);\n      const href = getCommandLink(command);\n      return [\n         Hs.div(styles.keyspaceHelp.command, He.a({href}, commandString))\n      ];\n   });\n}\n"]}